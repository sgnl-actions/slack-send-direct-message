# yaml-language-server: $schema=https://raw.githubusercontent.com/sgnl-actions/schemas/main/metadata.schema.json
name: slack-send-direct-message
description: Send a direct message to a Slack user by email

# Input parameters for web form generation
inputs:
  text:
    type: text
    description: The text message to send to the user
    required: true
    validation:
      min: 1
      max: 4000

  userEmail:
    type: text
    description: Email address of the Slack user to send the message to
    required: true
    validation:
      min: 5
      max: 254
      pattern: "^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$"

  delay:
    type: text
    description: Delay between API calls (e.g., 100ms, 1s). Default 100ms
    required: false
    validation:
      max: 50

  address:
    type: text
    description: Slack API base URL (e.g., https://slack.com)
    required: false
    validation:
      min: 1
      max: 255

# Secrets required for operation
secrets:
  BEARER_AUTH_TOKEN:
    description: Slack Bot User OAuth Token with users:read.email and chat:write scopes
    required: true

# Environment variables
environment:
  ADDRESS:
    description: Base URL for Slack API
    default: "https://slack.com"

# Expected output structure
outputs:
  status:
    type: text
    description: Operation result (success, failed, recovered, etc.)

  userEmail:
    type: text
    description: The email address of the user the message was sent to

  userId:
    type: text
    description: The Slack user ID that was resolved from the email

  text:
    type: text
    description: The message text that was sent

  ts:
    type: text
    description: The timestamp of the sent message from Slack API

  ok:
    type: boolean
    description: Whether the Slack API call was successful